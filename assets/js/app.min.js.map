{"version":3,"names":["Landing","window","__pcLandingBooted","init","finish","el","sessionStorage","setItem","_unused3","document","documentElement","classList","add","OUT_MS","parseFloat","getComputedStyle","getPropertyValue","setTimeout","parentNode","removeChild","body","remove","container","querySelector","gsap","fromTo","scale","duration","ease","overwrite","getElementById","cs","display","visibility","showOnce","dataset","getItem","_unused4","requestAnimationFrame","vid","srcEl","src","load","addEventListener","play","_unused5","once","tabIndex","setAttribute","e","key","timeout","parseInt","elNow","csNow","passive","readyState","Home","constructor","this","state","bp","basepath","location","origin","basePath","URL","supportsWebP","checkWebPSupport","isSafari","navigator","userAgent","indexOf","initialRoute","currentIndex","pageTransitionTime","matchMedia","matches","scrollSpeed","draggableInstance","handleMouseWheel","bind","updateBounds","handleMouseMove","fullPath","pathname","relativePath","startsWith","slice","length","endsWith","initialState","path","filter","split","project","href","history","replaceState","initializeRouter","handleStateChange","isMobile","isTouch","maxTouchPoints","msMaxTouchPoints","event","navigate","url","arguments","undefined","base","target","relative","search","hash","pushState","error","console","setState","closeIndex","closeProject","closeAbout","showFeatured","closeFeatured","showFilter","showIndex","showProject","showAbout","additionalData","JSON","stringify","setActiveButton","activeButton","querySelectorAll","forEach","button","initializePage","figure","Math","random","initializeCanvas","loadMedia","showAdditionalMenu","scrollTo","categories","includes","projectSlug","clickedFigure","allFigures","initializeGallery","contains","initializeHiddenGallery","checkForCaption","hideAdditionalMenu","innerHTML","menu","style","width","fullWidth","offsetWidth","to","onComplete","menuButtons","opacity","stagger","initializeMobileEvents","closeMobileMenus","dispatchEvent","Event","bubbles","registerPlugin","Draggable","InertiaPlugin","config","nullTargetWarn","initializeFeaturedLayout","initializeObserver","initializeNavigation","observer","IntersectionObserver","entries","entry","isIntersecting","root","threshold","item","observe","calculateBounds","minX","innerWidth","minY","offsetHeight","innerHeight","maxX","maxY","currentX","getProperty","currentY","newX","deltaX","newY","deltaY","bounds","utils","clamp","x","y","onUpdate","update","applyBounds","containerInner","closest","mouseX","clientX","mouseY","clientY","nudgeAmountX","nudgeAmountY","kill","removeEventListener","create","type","edgeResistance","inertia","throwProps","throwResistance","maxDuration","minDuration","onDrag","onThrowUpdate","viewportWidth","viewportHeight","initialX","initialY","set","targetScale","items","img","link","imgWidth","attributes","value","imgHeight","height","ratio","randomSizeLongEdge","floor","itemWidth","itemHeight","concat","padding","parallax","toFixed","featuredContainer","figures","Array","from","map","i","j","insertBefore","nextSibling","Packery","itemSelector","resize","horizontalOrder","index","verticalOffset","transform","setNavigationListeners","initializeNavEvents","initializeProjectsEvents","initializeGalleryEvents","preventDefault","navTimeout","nav","clearTimeout","projectLinks","pageTitle","hoverTimeout","preventInteraction","title","textContent","parentContainer","otherFigure","prevButton","nextButton","closeButton","galleryInner","updateGallery","direction","slides","slide","loadAdjacentSlides","currentSlide","setGalleryFigureWidthSafari","loadedVideo","setVideoDimensions","currentSlideFirstFigure","currentSlideTitle","timeline","currentProjectSlug","projectSlides","projectIndex","toString","padStart","projectTotal","galleryIndexElement","newSlug","currentActiveSlug","newUrl","tagName","toLowerCase","clickX","screenWidth","hammer","Hammer","on","getAttribute","back","activeSlide","hiddenCaption","caption","activeFigures","activeFiguresArray","processedIndices","Set","has","isDiptych","nextFigure","sameProject","push","slideFigures","createElement","figureElement","Object","client","projectUrl","gallery","galleryjpeg","galleryWidth","galleryHeight","videoUrl","isPortrait","autoplay","_ref","camelCase","kebabCase","isVideo","mediaUrl","mediaWidth","mediaHeight","videoElement","poster","loop","playsInline","preload","muted","controls","controlsList","aspectRatio","appendChild","imgElement","srcjpeg","slidesInGallery","startIndex","clickedGallery","findIndex","some","startingSlideTitle","String","firstSlide","startVideos","videos","video","stopVideos","pause","totalSlides","hasAttribute","canvas","getContext","toDataURL","mediaElements","Promise","all","media","resolve","onloadeddata","onload","onerror","then","containerWidth","parentElement","clientWidth","containerHeight","clientHeight","intrinsicWidth","intrinsicHeight","widthRatio","heightRatio","min","finalWidth","round","finalHeight","nextElementSibling","nextMedia","nextIntrinsicWidth","nextWidthRatio","nextHeightRatio","nextFinalWidth","home"],"sources":["modules/home.js","app.js"],"sourcesContent":["// ===============================\n// Landing Overlay (Option A)\n// ===============================\nconst Landing = (() => {\n\tif (window.__pcLandingBooted) return { init() { } };\n\twindow.__pcLandingBooted = true;\n\n\tconst KEY = 'pcLandingSeen';\n\n\tfunction markSeen() {\n\t\ttry { sessionStorage.setItem(KEY, '1'); } catch { }\n\t\tdocument.documentElement.classList.add('landing-dismissed');\n\t}\n\n\tfunction markSeen() {\n\t\ttry { sessionStorage.setItem('pcLandingSeen', '1'); } catch { }\n\t\tdocument.documentElement.classList.add('landing-dismissed');\n\t}\n\n\t// UPDATED finish: fade overlay, then reveal + nudge featured in\n\tfunction finish(el) {\n\t\t// mark seen + fade overlay out\n\t\ttry { sessionStorage.setItem('pcLandingSeen', '1'); } catch { }\n\t\tdocument.documentElement.classList.add('landing-dismissed');\n\n\t\tel.classList.add('is-hidden');\n\n\t\tconst OUT_MS = parseFloat(getComputedStyle(el).getPropertyValue('--landing-fade-out')) || 500;\n\n\t\tsetTimeout(() => {\n\t\t\tif (el && el.parentNode) el.parentNode.removeChild(el);\n\n\t\t\t// Reveal the app\n\t\t\tdocument.body.classList.remove('has-landing');\n\n\t\t\t// Gentle container nudge only â€” leave figures alone\n\t\t\tconst container = document.querySelector('.featured-items');\n\t\t\tif (container && window.gsap) {\n\t\t\t\tgsap.fromTo(\n\t\t\t\t\tcontainer,\n\t\t\t\t\t{ scale: 0.97 },                   // start almost at 1\n\t\t\t\t\t{ scale: 1, duration: 1.1, ease: 'power2.out', overwrite: 'auto' }\n\t\t\t\t);\n\t\t\t}\n\t\t}, OUT_MS);\n\t}\n\n\tfunction init() {\n\t\tconst el = document.getElementById('landing-overlay');\n\n\t\t// If there's no overlay element, ensure the app is visible\n\t\tif (!el) {\n\t\t\tdocument.body.classList.remove('has-landing');\n\t\t\treturn;\n\t\t}\n\n\t\t// If the overlay is present but CSS-hidden (e.g. someone re-added a media query)\n\t\tconst cs = window.getComputedStyle(el);\n\t\tif (cs.display === 'none' || cs.visibility === 'hidden') {\n\t\t\tdocument.body.classList.remove('has-landing');\n\t\t\treturn;\n\t\t}\n\n\t\t// Normal path\n\t\tdocument.body.classList.add('has-landing');\n\n\t\tconst showOnce = el.dataset.showOnce === '1';\n\t\ttry {\n\t\t\tif (showOnce && sessionStorage.getItem('pcLandingSeen') === '1') {\n\t\t\t\tdocument.documentElement.classList.add('landing-dismissed');\n\t\t\t\tel.remove();\n\t\t\t\tdocument.body.classList.remove('has-landing');\n\t\t\t\treturn;\n\t\t\t}\n\t\t} catch { }\n\n\t\t// Fade-in enter state\n\t\trequestAnimationFrame(() => el.classList.add('is-entered'));\n\n\t\t// Fade overlay in\n\t\trequestAnimationFrame(() => {\n\t\t\tel.classList.add('is-entered');\n\n\t\t\t// Lazy-attach video src when overlay becomes visible\n\t\t\tconst vid = document.getElementById('landing-video');\n\t\t\tif (vid) {\n\t\t\t\tconst srcEl = vid.querySelector('source[data-src]');\n\t\t\t\tif (srcEl && !srcEl.src) {\n\t\t\t\t\tsrcEl.src = srcEl.dataset.src;\n\t\t\t\t\tvid.load();\n\t\t\t\t\tvid.addEventListener('canplay', () => {\n\t\t\t\t\t\ttry { vid.play(); } catch { }\n\t\t\t\t\t}, { once: true });\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\n\t\t// Click anywhere to finish\n\t\tel.addEventListener('click', () => finish(el));\n\n\t\t// Keyboard\n\t\tel.tabIndex = 0;\n\t\tel.setAttribute('role', 'button');\n\t\tel.addEventListener('keydown', (e) => {\n\t\t\tif (e.key === 'Enter' || e.key === ' ' || e.key === 'Escape') finish(el);\n\t\t});\n\n\t\t// Optional timeout\n\t\tconst timeout = parseInt(el.dataset.timeout || '0', 10);\n\t\tif (timeout > 0) setTimeout(() => finish(el), timeout);\n\n\t\t// Safety: if someone resizes to a breakpoint that hides the overlay, un-dim the app\n\t\twindow.addEventListener('resize', () => {\n\t\t\tconst elNow = document.getElementById('landing-overlay');\n\t\t\tif (!elNow) { document.body.classList.remove('has-landing'); return; }\n\t\t\tconst csNow = getComputedStyle(elNow);\n\t\t\tif (csNow.display === 'none' || csNow.visibility === 'hidden') {\n\t\t\t\tdocument.body.classList.remove('has-landing');\n\t\t\t}\n\t\t}, { passive: true });\n\t}\n\n\treturn { init };\n})();\n\n// Initialise AFTER DOM is ready (place once at end of home.js, outside the class)\nif (document.readyState === 'loading') {\n\tdocument.addEventListener('DOMContentLoaded', () => Landing.init());\n} else {\n\tLanding.init();\n}\n\nexport default class Home {\n\tconstructor() {\n\t\tthis.state = null; // Current app state\n\t\t//this.basePath = document.body.getAttribute(\"data-basepath\") === \"https://paulcalver.co\" || document.body.getAttribute(\"data-basepath\") === \"https://paulcalver.cc\" ? document.body.getAttribute(\"data-basepath\") : new URL(document.body.getAttribute(\"data-basepath\") || window.location.origin).pathname; // Extract the path portion of the base URL\n\n\t\tconst bp = document.body.dataset.basepath || window.location.origin;\n\t\t// Use the full origin instead of .pathname so localhost isnâ€™t just \"/\"\n\t\tthis.basePath = (\n\t\t\tbp === 'https://paulcalver.co' || bp === 'https://paulcalver.cc'\n\t\t) ? bp : new URL(bp).origin;\n\t\t// this.basePath = document.body.getAttribute(\"data-basepath\"); // Extract the path portion of the base URL\n\n\t\tthis.supportsWebP = this.checkWebPSupport();\n\n\t\tthis.isSafari = navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1;\n\n\n\t\tthis.initialRoute = true;\n\t\tthis.currentIndex = 0; // Initialize the currentIndex at 0\n\t\tthis.pageTransitionTime = window.matchMedia(\"(max-width: 768px)\").matches ? 10 : 500; // Duration of the page transition animation\n\n\t\tthis.scale = 1; // Default scale\n\t\tthis.scrollSpeed = 3; // Global scroll sensitivity\n\t\tthis.draggableInstance = null;\n\n\t\t// Bind event listeners to ensure they can be properly added/removed\n\t\tthis.handleMouseWheel = this.handleMouseWheel.bind(this);\n\t\tthis.updateBounds = this.updateBounds.bind(this);\n\t\tthis.handleMouseMove = this.handleMouseMove.bind(this);\n\n\n\t\tif (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1) {\n\t\t\tdocument.querySelector('html').classList.add('is-safari');\n\t\t}\n\n\t\t// Determine initial state based on the current URL\n\t\tconst fullPath = window.location.pathname;\n\t\tlet relativePath = fullPath.startsWith(this.basePath)\n\t\t\t? fullPath.slice(this.basePath.length)\n\t\t\t: fullPath;\n\n\t\t// Remove trailing slash if present (except for root \"/\")\n\t\trelativePath = relativePath.endsWith(\"/\") && relativePath !== \"/\"\n\t\t\t? relativePath.slice(0, -1)\n\t\t\t: relativePath;\n\n\t\t// Prepare initial state data\n\t\tlet initialState = { path: relativePath };\n\t\tif (relativePath === \"/\" || relativePath === \"\") {\n\t\t\tinitialState = { state: \"featured\" };\n\t\t} else if (relativePath.startsWith(\"/filter/\")) {\n\t\t\tconst filter = relativePath.split(\"/filter/\")[1];\n\t\t\tinitialState = { state: \"filter\", filter };\n\t\t} else if (relativePath === \"/projects\") {\n\t\t\tinitialState = { state: \"index\" };\n\t\t} else if (relativePath.startsWith(\"/projects/\")) {\n\t\t\tconst project = relativePath.split(\"/projects/\")[1];\n\t\t\t// console.log(project);\n\t\t\tinitialState = { state: \"project\", project };\n\t\t} else if (relativePath === \"/about\") {\n\t\t\tinitialState = { state: \"about\" };\n\t\t} else {\n\t\t\twindow.location.href = this.basePath; // Redirect to basePath for unknown routes\n\t\t}\n\n\t\t// Set the initial state in history\n\t\thistory.replaceState(initialState, \"\", window.location.href);\n\n\t\tthis.initializeRouter();\n\t\tthis.handleStateChange();\n\n\t\t// Initialise Landing overlay\n\t\t// Landing.init();\n\t}\n\n\tisMobile() {\n\t\treturn window.matchMedia(\"(max-width: 768px)\").matches;\n\t}\n\n\tisTouch() {\n\t\treturn 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;\n\t}\n\n\tinitializeRouter() {\n\t\twindow.addEventListener(\"popstate\", (event) => {\n\t\t\tthis.handleStateChange();\n\t\t\t// console.log(\"Popstate triggered with state:\", event.state);\n\t\t});\n\t}\n\n\t// navigate(url, state = {}) {\n\t// \ttry {\n\t// \t\tconst fullUrl = this.basePath + url;\n\t// \t\t// console.log(fullUrl, this.basePath, url);\n\t// \t\thistory.pushState(state, \"\", fullUrl);\n\n\t// \t\t// Trigger `handleStateChange` only if not on the initial route\n\t// \t\tif (!this.initialRoute) {\n\t// \t\t\tthis.handleStateChange();\n\t// \t\t}\n\t// \t} catch (error) {\n\t// \t\tconsole.error(\"Failed to navigate:\", error);\n\t// \t}\n\t// }\n\n\tnavigate(url, state = {}) {\n\t\ttry {\n\t\t\t// Resolve the target against a safe base (works local + live)\n\t\t\tconst base = document.body.dataset.basepath || window.location.origin;\n\t\t\tconst target = new URL(url, base);\n\n\t\t\t// Push a same-origin relative URL to avoid cross-origin pushState errors\n\t\t\tconst relative = target.pathname + target.search + target.hash;\n\t\t\thistory.pushState(state, \"\", relative);\n\n\t\t\tif (!this.initialRoute) this.handleStateChange();\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Failed to navigate:\", error);\n\t\t}\n\t}\n\n\thandleStateChange() {\n\t\tconst fullPath = window.location.pathname;\n\n\t\t// Strip the base path from the current pathname\n\t\tlet relativePath = fullPath.startsWith(this.basePath)\n\t\t\t? fullPath.slice(this.basePath.length)\n\t\t\t: fullPath;\n\n\t\trelativePath = relativePath.endsWith(\"/\") && relativePath !== \"/\"\n\t\t\t? relativePath.slice(0, -1)\n\t\t\t: relativePath;\n\n\n\t\tif (relativePath === \"/\" || relativePath === \"\") {\n\t\t\tthis.setState(\"featured\");\n\t\t\tif (!this.initialRoute) {\n\t\t\t\tthis.closeIndex();\n\t\t\t\tthis.closeProject();\n\t\t\t\tthis.closeAbout();\n\t\t\t}\n\t\t\tthis.showFeatured(this.initialRoute); // Only call `showHome` here\n\t\t} else if (relativePath.startsWith(\"/filter/\")) {\n\t\t\tconst filter = relativePath.split(\"/filter/\")[1];\n\t\t\tthis.setState(\"filter\", { filter });\n\t\t\tif (!this.initialRoute) {\n\t\t\t\tthis.closeFeatured();\n\t\t\t\tthis.closeProject();\n\t\t\t\tthis.closeAbout();\n\t\t\t}\n\t\t\tthis.showFilter(filter, this.initialRoute); // Only call `showFilter` here\n\t\t} else if (relativePath === \"/projects\") {\n\t\t\tthis.setState(\"index\");\n\t\t\tif (!this.initialRoute) {\n\t\t\t\tthis.closeFeatured();\n\t\t\t\tthis.closeProject();\n\t\t\t\tthis.closeAbout();\n\t\t\t}\n\t\t\tthis.showIndex(this.initialRoute); // Only call `showProjects` here\n\t\t} else if (relativePath.startsWith(\"/projects/\")) {\n\t\t\tconst project = relativePath.split(\"/projects/\")[1];\n\t\t\tthis.setState(\"project\", { project });\n\t\t\tif (!this.initialRoute) {\n\t\t\t\tthis.closeFeatured();\n\t\t\t\tthis.closeIndex();\n\t\t\t\tthis.closeAbout();\n\t\t\t}\n\t\t\tthis.showProject(project, null, null, this.initialRoute); // Pass no clicked item\n\t\t} else if (relativePath === \"/about\") {\n\t\t\tthis.setState(\"about\");\n\t\t\tif (!this.initialRoute) {\n\t\t\t\tthis.closeFeatured();\n\t\t\t\tthis.closeIndex();\n\t\t\t\tthis.closeProject();\n\t\t\t}\n\t\t\tthis.showAbout(this.initialRoute); // Only call `showAbout` here\n\t\t} else {\n\t\t\tconsole.error(\"Unknown state for relative path:\", relativePath);\n\t\t}\n\n\n\t\t// Set initialRoute to false after the first run\n\t\tif (this.initialRoute) {\n\t\t\tthis.initialRoute = false;\n\t\t\t// console.log(\"Initial route setup complete\");\n\t\t}\n\t}\n\n\tsetState(state, additionalData = null) {\n\t\tif (this.state === state && JSON.stringify(this.additionalData) === JSON.stringify(additionalData)) {\n\t\t\treturn; // Avoid redundant updates\n\t\t}\n\n\t\tthis.state = state;\n\t\tthis.additionalData = additionalData;\n\n\t\t// Log state changes for debugging\n\t\t// console.log(\"State updated:\", state, additionalData);\n\t}\n\n\tsetActiveButton(activeButton) {\n\t\tconst buttons = document.querySelectorAll('.menu a');\n\t\tbuttons.forEach(button => button.classList.remove('active-button'));\n\t\tactiveButton.classList.add('active-button');\n\t}\n\n\n\t// Methods to handle visuals for each state\n\tshowFeatured(initialRoute = false) {\n\t\tlet timeout = initialRoute ? 0 : this.pageTransitionTime;\n\n\t\tif (initialRoute) {\n\t\t\t// console.log(\"Initial route detected\");\n\n\n\t\t\tthis.initializePage();\n\n\n\n\t\t} else {\n\n\n\t\t}\n\n\t\tdocument.querySelector('.featured').classList.add('active-section');\n\t\tdocument.body.classList.add('featured-active');\n\t\tthis.setActiveButton(document.querySelector('.featured-link'));\n\n\n\n\n\t\tsetTimeout(() => {\n\n\n\t\t\tdocument.querySelectorAll('.featured figure').forEach(figure => {\n\t\t\t\tfigure.classList.remove('hide');\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tfigure.classList.remove('unfiltered-figure');\n\t\t\t\t}, 10);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tfigure.classList.remove('stagger');\n\t\t\t\t}, Math.random() * 1200);\n\t\t\t});\n\n\t\t\tif (!this.isMobile()) {\n\t\t\t\tthis.initializeCanvas(document.querySelector('.featured-items'), initialRoute);\n\t\t\t}\n\n\n\t\t\tthis.loadMedia(document.querySelector('.featured'));\n\t\t}, timeout);\n\n\t}\n\n\tshowIndex(initialRoute = false) {\n\t\tlet timeout = initialRoute ? 0 : this.pageTransitionTime;\n\t\tif (initialRoute) {\n\t\t\t// console.log(\"Initial route detected\");\n\n\n\t\t\tthis.initializePage();\n\n\n\t\t} else {\n\n\n\t\t}\n\n\t\t// setTimeout(() => {\n\t\tif (!this.isMobile()) {\n\t\t\tthis.showAdditionalMenu(document.querySelector('.filters'));\n\t\t}\n\t\t// }, 1000);\n\n\t\tdocument.querySelector('.index').classList.add('active-section');\n\t\tdocument.body.classList.add('index-active');\n\t\tthis.setActiveButton(document.querySelector('.index-link'));\n\n\t\tdocument.querySelectorAll('.index figure').forEach(figure => {\n\t\t\tfigure.classList.add('unfiltered-figure');\n\t\t\tfigure.classList.add('stagger');\n\t\t});\n\n\n\n\t\tsetTimeout(() => {\n\n\t\t\tdocument.querySelectorAll('.index figure').forEach(figure => {\n\t\t\t\tfigure.classList.add('hide');\n\t\t\t\tfigure.classList.remove('hide');\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tfigure.classList.remove('unfiltered-figure');\n\t\t\t\t}, 10);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tfigure.classList.remove('stagger');\n\t\t\t\t}, Math.random() * 1200);\n\t\t\t});\n\n\t\t\tif (!this.isMobile()) {\n\t\t\t\tthis.initializeCanvas(document.querySelector('.index-items'));\n\t\t\t}\n\n\t\t\tthis.loadMedia(document.querySelector('.index'));\n\t\t}, timeout);\n\n\t}\n\n\tshowFilter(filter, initialRoute = false) {\n\t\tlet timeout = initialRoute ? 0 : this.pageTransitionTime;\n\t\tif (initialRoute) {\n\t\t\t// console.log(\"Initial route detected\");\n\n\n\t\t\tthis.initializePage();\n\n\n\t\t} else {\n\n\n\t\t}\n\n\t\t// setTimeout(() => {\n\t\tif (!this.isMobile()) {\n\t\t\tthis.showAdditionalMenu(document.querySelector('.filters'));\n\t\t}\n\t\t// }, 1000);\n\n\t\tdocument.querySelector('.index').classList.add('active-section');\n\t\tdocument.body.classList.add('index-active');\n\t\tthis.setActiveButton(document.querySelector('.filter-button[data-filter=\"' + filter + '\"]'));\n\n\t\tdocument.querySelectorAll('.index figure').forEach(figure => {\n\t\t\tfigure.classList.add('unfiltered-figure');\n\t\t\tfigure.classList.add('stagger');\n\t\t});\n\n\n\n\t\tsetTimeout(() => {\n\n\t\t\tif (this.isMobile()) {\n\n\t\t\t\tdocument.querySelector('.index').scrollTo(0, 0);\n\n\t\t\t}\n\n\t\t\tdocument.querySelectorAll('.index figure').forEach(figure => {\n\n\t\t\t\tfigure.classList.add('hide');\n\n\t\t\t\tconst categories = figure.dataset.categories ? figure.dataset.categories.split(',') : [];\n\t\t\t\tconst shouldShow = !filter || categories.includes(filter);\n\n\t\t\t\tif (shouldShow) {\n\t\t\t\t\tfigure.classList.remove('hide');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tfigure.classList.remove('unfiltered-figure');\n\t\t\t\t\t}, 10);\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tfigure.classList.remove('stagger');\n\t\t\t\t\t}, Math.random() * 300);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!this.isMobile()) {\n\t\t\t\tthis.initializeCanvas(document.querySelector('.index-items'));\n\t\t\t}\n\n\n\t\t\tthis.loadMedia(document.querySelector('.index'));\n\t\t}, timeout);\n\n\t}\n\n\tshowProject(projectSlug, clickedFigure = null, allFigures = null, initialRoute = false) {\n\t\tlet timeout = initialRoute ? 0 : this.pageTransitionTime;\n\t\tif (initialRoute) {\n\t\t\t// console.log(\"Initial route detected\");\n\n\t\t\tthis.initializePage(initialRoute);\n\n\t\t} else {\n\n\n\t\t}\n\n\n\n\t\tsetTimeout(() => {\n\t\t\tconst gallery = document.querySelector('.gallery');\n\t\t\tgallery.classList.add('active-section');\n\t\t\tthis.initializeGallery(projectSlug, clickedFigure, allFigures, initialRoute);\n\t\t\tif (!document.body.classList.contains('hidden-page')) {\n\t\t\t\t// this.initializeGallery(projectSlug, clickedFigure, allFigures, initialRoute);\n\t\t\t} else {\n\t\t\t\tthis.initializeHiddenGallery();\n\t\t\t\tthis.checkForCaption();\n\t\t\t}\n\t\t\tdocument.body.classList.add('gallery-active');\n\t\t}, timeout);\n\t}\n\n\tshowAbout(initialRoute = false) {\n\t\tlet timeout = initialRoute ? 0 : this.pageTransitionTime;\n\t\tif (initialRoute) {\n\t\t\t// console.log(\"Initial route detected\");\n\n\t\t\tthis.initializePage();\n\n\t\t} else {\n\n\n\t\t}\n\n\t\t// setTimeout(() => {\n\t\tif (!this.isMobile()) {\n\t\t\tthis.showAdditionalMenu(document.querySelector('.external-links'));\n\t\t}\n\t\t// }, 1000);\n\n\t\tsetTimeout(() => {\n\t\t\tdocument.querySelector('.about').classList.add('active-section');\n\t\t\tdocument.body.classList.add('about-active');\n\t\t\tthis.setActiveButton(document.querySelector('.about-link'));\n\t\t}, timeout);\n\n\n\t}\n\n\n\n\tcloseFeatured() {\n\t\t// console.log('close featured');\n\n\n\t\tsetTimeout(() => {\n\t\t\tdocument.querySelector('.featured').classList.remove('active-section');\n\t\t\tdocument.body.classList.remove('featured-active');\n\t\t}, this.pageTransitionTime);\n\n\t\tdocument.querySelectorAll('.featured figure').forEach(figure => {\n\t\t\tfigure.classList.add('unfiltered-figure');\n\t\t\tfigure.classList.add('stagger');\n\t\t\tsetTimeout(() => {\n\t\t\t\tfigure.classList.add('hide');\n\t\t\t}, this.pageTransitionTime);\n\t\t});\n\t}\n\n\tcloseIndex() {\n\t\t// console.log('close projects');\n\n\t\tsetTimeout(() => {\n\t\t\tdocument.querySelector('.index').classList.remove('active-section');\n\t\t\tdocument.body.classList.remove('index-active');\n\t\t}, this.pageTransitionTime);\n\n\t\t// setTimeout(() => {\n\t\tif (!this.isMobile()) {\n\t\t\tthis.hideAdditionalMenu(document.querySelector('.filters'));\n\t\t}\n\t\t// }, 1000);\n\n\t\tdocument.querySelectorAll('.index figure').forEach(figure => {\n\t\t\tfigure.classList.add('unfiltered-figure');\n\t\t\tfigure.classList.add('stagger');\n\t\t\tsetTimeout(() => {\n\t\t\t\tfigure.classList.add('hide');\n\t\t\t}, this.pageTransitionTime);\n\t\t});\n\t}\n\n\tcloseProject() {\n\t\tdocument.querySelector('.gallery').classList.remove('active-section');\n\t\tdocument.body.classList.remove('gallery-active');\n\t\tsetTimeout(() => {\n\t\t\tdocument.querySelector('.gallery-inner').innerHTML = '';\n\t\t}, this.pageTransitionTime);\n\t}\n\n\tcloseAbout() {\n\t\tdocument.querySelector('.about').classList.remove('active-section');\n\t\tdocument.body.classList.remove('about-active');\n\n\t\t// setTimeout(() => {\n\t\tif (!this.isMobile()) {\n\t\t\tthis.hideAdditionalMenu(document.querySelector('.external-links'));\n\t\t}\n\t\t// }, 1000);\n\t}\n\n\tshowAdditionalMenu(menu) {\n\t\tif (!menu || menu.style.width === 'auto') return;\n\t\tmenu.style.width = 'auto';\n\t\tconst fullWidth = menu.offsetWidth;\n\n\t\t// Reset width to 0 to prepare for animation\n\t\tmenu.style.width = '0';\n\n\t\t// Animate the width using GSAP\n\t\tgsap.to(menu, {\n\t\t\twidth: fullWidth,\n\t\t\tduration: 0.5,\n\t\t\tease: 'power4.out',\n\t\t\tonComplete: () => {\n\t\t\t\t// Optional: Clean up inline styles if necessary\n\t\t\t\tmenu.style.width = 'auto';\n\n\t\t\t\tconst menuButtons = menu.querySelectorAll('a');\n\t\t\t\tgsap.to(menuButtons, {\n\t\t\t\t\topacity: 1,\n\t\t\t\t\tduration: 0.5,\n\t\t\t\t\tstagger: 0.1, // Stagger animation for each button\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\thideAdditionalMenu(menu) {\n\t\tif (!menu) return;\n\t\tconst menuButtons = menu.querySelectorAll('a');\n\n\t\tgsap.to(menuButtons, {\n\t\t\topacity: 0,\n\t\t\tduration: 0.5,\n\t\t\tstagger: -0.1, // Stagger animation for each button\n\t\t\tonComplete: () => {\n\t\t\t\tgsap.to(menu, {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\tduration: 0.5,\n\t\t\t\t\tease: 'power4.out',\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tinitializeMobileEvents() {\n\t\tdocument.querySelector('.mobile-button-filters').addEventListener('click', () => {\n\t\t\tdocument.body.classList.add('mobile-filters-open');\n\t\t});\n\n\t\tdocument.querySelector('.mobile-button-menu').addEventListener('click', () => {\n\t\t\tdocument.body.classList.add('mobile-menu-open');\n\t\t});\n\n\t\tdocument.querySelector('.mobile-button-close').addEventListener('click', () => {\n\t\t\tthis.closeMobileMenus();\n\t\t});\n\t}\n\n\tcloseMobileMenus() {\n\t\tif (document.body.classList.contains('gallery-active')) {\n\t\t\tconst closeButton = document.querySelector('.project-controls .close');\n\t\t\tcloseButton.dispatchEvent(new Event('click', { bubbles: true }));\n\t\t} else {\n\t\t\tdocument.body.classList.remove('mobile-menu-open');\n\t\t\tdocument.body.classList.remove('mobile-filters-open');\n\t\t}\n\t}\n\n\tinitializePage(initialRoute = false) {\n\n\t\tgsap.registerPlugin(Draggable, InertiaPlugin);\n\t\tgsap.config({\n\t\t\tnullTargetWarn: false,\n\t\t});\n\n\t\tif (!this.isMobile()) {\n\t\t\tthis.initializeFeaturedLayout();\n\t\t\tthis.initializeObserver();\n\t\t} else {\n\t\t\tthis.initializeMobileEvents();\n\t\t}\n\n\t\tthis.initializeNavigation(initialRoute);\n\t}\n\n\tinitializeObserver() {\n\t\tconst observer = new IntersectionObserver((entries) => {\n\t\t\tentries.forEach(entry => {\n\t\t\t\tif (entry.isIntersecting) {\n\t\t\t\t\t// Image is in view, set opacity to 1 and scale to 1\n\t\t\t\t\tgsap.to(entry.target, {\n\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\tscale: 1,  // Scale to 1 when visible\n\t\t\t\t\t\tduration: 1,\n\t\t\t\t\t\tease: \"power2.out\"\n\t\t\t\t\t});\n\n\t\t\t\t} else {\n\t\t\t\t\t// Image is out of view, set opacity to 0.5 and scale to 0.75\n\t\t\t\t\tgsap.to(entry.target, {\n\t\t\t\t\t\topacity: 0.25,\n\t\t\t\t\t\tscale: 0.9,  // Scale down when not visible\n\t\t\t\t\t\tduration: 1,\n\t\t\t\t\t\tease: \"power2.out\"\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\t\t}, {\n\t\t\troot: null,  // Track visibility relative to the viewport\n\t\t\tthreshold: 0.1 // Trigger when at least 10% of the image is visible\n\t\t});\n\n\t\tdocument.querySelectorAll('.index .project-link-inner, .featured .project-link-inner').forEach(item => {\n\t\t\tobserver.observe(item);\n\t\t});\n\t}\n\n\tcalculateBounds(container) {\n\t\tconst maxX = -container.offsetWidth * this.scale + window.innerWidth;\n\t\tconst maxY = -container.offsetHeight * this.scale + window.innerHeight;\n\t\treturn { minX: maxX, minY: maxY, maxX: 0, maxY: 0 };\n\t}\n\n\thandleMouseWheel(event) {\n\t\tif (!this.draggableInstance) return;\n\n\t\tconst container = this.draggableInstance.target;\n\t\tconst currentX = gsap.getProperty(container, 'x');\n\t\tconst currentY = gsap.getProperty(container, 'y');\n\n\t\tlet newX = currentX - event.deltaX * this.scrollSpeed;\n\t\tlet newY = currentY - event.deltaY * this.scrollSpeed;\n\n\t\tconst bounds = this.calculateBounds(container);\n\n\t\tnewX = gsap.utils.clamp(bounds.minX, bounds.maxX, newX);\n\t\tnewY = gsap.utils.clamp(bounds.minY, bounds.maxY, newY);\n\n\t\tgsap.to(container, {\n\t\t\tx: newX,\n\t\t\ty: newY,\n\t\t\tduration: 0.3,\n\t\t\tease: \"power2.out\",\n\t\t\tonUpdate: () => this.draggableInstance.update(),\n\t\t\tonComplete: () => this.draggableInstance.update(),\n\t\t});\n\n\t\tthis.updateBounds();\n\t}\n\n\tupdateBounds() {\n\t\tif (this.draggableInstance) {\n\t\t\tconst container = this.draggableInstance.target;\n\t\t\tthis.draggableInstance.applyBounds(this.calculateBounds(container));\n\t\t}\n\t}\n\n\thandleMouseMove(e) {\n\t\tif (!this.draggableInstance) return;\n\n\t\tconst containerInner = this.draggableInstance.target.closest('.container-inner');\n\t\tconst maxNudge = 50;\n\t\tconst mouseX = e.clientX;\n\t\tconst mouseY = e.clientY;\n\n\t\tconst nudgeAmountX = ((mouseX / window.innerWidth) - 0.5) * maxNudge;\n\t\tconst nudgeAmountY = ((mouseY / window.innerHeight) - 0.5) * maxNudge;\n\n\t\tgsap.to(containerInner, {\n\t\t\tx: nudgeAmountX,\n\t\t\ty: nudgeAmountY,\n\t\t\tduration: 1.5,\n\t\t\tease: 'power3.out',\n\t\t});\n\t}\n\n\tinitializeCanvas(container, initialRoute = false) {\n\t\tconst containerInner = container.closest('.container-inner');\n\n\t\t// Remove previous Draggable instance\n\t\tif (this.draggableInstance) {\n\t\t\tthis.draggableInstance.kill();\n\t\t}\n\n\t\t// Remove existing event listeners\n\t\twindow.removeEventListener('wheel', this.handleMouseWheel);\n\t\twindow.removeEventListener('resize', this.updateBounds);\n\t\twindow.removeEventListener('mousemove', this.handleMouseMove);\n\n\t\tthis.draggableInstance = Draggable.create(container, {\n\t\t\ttype: \"x,y\",\n\t\t\tedgeResistance: 0.85,\n\t\t\tinertia: true,\n\t\t\tbounds: this.calculateBounds(container),\n\t\t\tthrowProps: true,\n\t\t\tthrowResistance: 20000,\n\t\t\tmaxDuration: 3,\n\t\t\tminDuration: 0.5,\n\t\t\tonDrag: () => {\n\t\t\t\tconst bounds = this.calculateBounds(container);\n\t\t\t\tgsap.utils.clamp(bounds.minX, bounds.maxX, gsap.getProperty(container, 'x'));\n\t\t\t\tgsap.utils.clamp(bounds.minY, bounds.maxY, gsap.getProperty(container, 'y'));\n\t\t\t},\n\t\t\tonThrowUpdate: () => {\n\t\t\t\tthis.updateBounds();\n\t\t\t}\n\t\t})[0];\n\n\t\t// Add event listeners\n\t\twindow.addEventListener('wheel', this.handleMouseWheel);\n\t\twindow.addEventListener('resize', this.updateBounds);\n\t\twindow.addEventListener('mousemove', this.handleMouseMove);\n\n\t\t// Center the container\n\t\tconst viewportWidth = window.innerWidth;\n\t\tconst viewportHeight = window.innerHeight;\n\n\t\tconst containerWidth = container.offsetWidth;\n\t\tconst containerHeight = container.offsetHeight;\n\n\t\tconst initialX = (viewportWidth - containerWidth) / 2;\n\t\tconst initialY = (viewportHeight - containerHeight) / 2;\n\n\t\tgsap.set(container, {\n\t\t\tx: initialX,\n\t\t\ty: initialY,\n\t\t});\n\n\t\tif (container.classList.contains('featured-items') && initialRoute) {\n\t\t\t// this.preventInteraction = true;\n\t\t\tconst targetScale = 0.7;\n\t\t\tgsap.to(container, {\n\t\t\t\tscale: targetScale,\n\t\t\t\tduration: 0,\n\t\t\t\tease: 'power3.out',\n\t\t\t\tonUpdate: this.updateBounds()\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst animationDuration = 2; // Total duration of the animation in seconds\n\n\t\t\t\t// Scale animation\n\t\t\t\tgsap.to(container, {\n\t\t\t\t\tscale: 1,\n\t\t\t\t\tduration: animationDuration,\n\t\t\t\t\tease: 'power3.out',\n\t\t\t\t\tonUpdate: () => this.updateBounds(),\n\t\t\t\t});\n\n\t\t\t}, 50);\n\t\t};\n\t}\n\n\n\n\n\tinitializeFeaturedLayout() {\n\t\tlet totalWidth = 0;\n\t\tlet totalHeight = 0;\n\t\tlet totalArea = 0;\n\n\t\tconst items = document.querySelectorAll('.featured img, .featured video');\n\t\tconst totalItems = items.length;\n\n\t\tconst margins = 40; // Example margin size (left and right)\n\n\t\titems.forEach((img) => {\n\t\t\tconst figure = img.closest('figure');\n\t\t\tconst link = figure.querySelector('.project-link-inner');\n\t\t\tconst imgWidth = parseInt(img.attributes.width.value, 10);\n\t\t\tconst imgHeight = parseInt(img.attributes.height.value, 10);\n\n\t\t\tconst ratio = imgWidth / imgHeight; // Aspect ratio (width divided by height)\n\n\t\t\t// Random size for the long edge between 240 and 480\n\t\t\tconst min = 240;\n\t\t\tconst max = 480;\n\t\t\tconst randomSizeLongEdge = Math.floor(Math.random() * (max - min + 1) + min);\n\n\t\t\tlet itemWidth, itemHeight;\n\n\t\t\t// Determine if width or height is the longest edge\n\t\t\tif (imgWidth >= imgHeight) {\n\t\t\t\t// Width is the longest edge\n\t\t\t\titemWidth = randomSizeLongEdge;\n\t\t\t\titemHeight = Math.floor(randomSizeLongEdge / ratio);\n\t\t\t} else {\n\t\t\t\t// Height is the longest edge\n\t\t\t\titemHeight = randomSizeLongEdge;\n\t\t\t\titemWidth = Math.floor(randomSizeLongEdge * ratio);\n\t\t\t}\n\n\t\t\t// Add the item's width and height, including margins\n\t\t\ttotalWidth += itemWidth + margins;\n\t\t\ttotalHeight += itemHeight + margins;\n\n\t\t\ttotalArea += (itemWidth + margins) * (itemHeight + margins);\n\n\t\t\tlink.style.width = `${itemWidth}px`;\n\t\t\tlink.style.height = `${itemHeight}px`;\n\n\t\t\tconst minPadding = 50;\n\t\t\tconst maxPadding = 80;\n\n\t\t\tfigure.style.padding = `${Math.floor(Math.random() * (maxPadding - minPadding + 1) + minPadding)}px`;\n\n\t\t\tfigure.dataset.parallax = (Math.random() * 0.4 + 0.1).toFixed(2);\n\t\t});\n\n\t\t// Calculate grid dimensions based on 4:3 ratio\n\t\tconst approximateRows = Math.ceil(Math.sqrt(totalItems * (3 / 4))); // More rows due to 4:3\n\t\tconst approximateCols = Math.ceil(totalItems / approximateRows);\n\n\t\t// Calculate the container width based on the grid\n\t\tconst containerWidth = approximateCols * (totalWidth / totalItems);\n\t\tconst containerHeight = approximateRows * (totalHeight / totalItems);\n\n\t\t// Ensure container height roughly matches 4:3 ratio\n\t\tconst adjustedContainerWidth = Math.max(containerWidth, containerHeight * (4 / 3));\n\n\t\tconst featuredContainer = document.querySelector('.featured-items');\n\t\t// featuredContainer.style.width = `${adjustedContainerWidth}px`;\n\n\t\t// Shuffle the items array to randomize their order\n\t\tconst itemsArray = Array.from(items);\n\t\tconst figures = itemsArray.map(item => item.closest('figure'));\n\n\t\t// Fisher-Yates shuffle\n\t\tfor (let i = figures.length - 1; i > 0; i--) {\n\t\t\tconst j = Math.floor(Math.random() * (i + 1));\n\t\t\tfeaturedContainer.insertBefore(figures[j], figures[i].nextSibling);\n\t\t}\n\n\t\t// Initialize Packery layout with horizontal order\n\t\tvar iso = new Packery('.featured-items', {\n\t\t\titemSelector: 'figure',\n\t\t\tresize: false,\n\t\t\thorizontalOrder: false // Allow more natural filling\n\t\t});\n\n\t\tfeaturedContainer.style.width = document.querySelector('.featured-items').offsetWidth + 'px';\n\n\t\t// Add some random vertical offset to avoid strict top alignment\n\t\tconst figureElements = featuredContainer.querySelectorAll('figure');\n\t\tfigureElements.forEach((figure, index) => {\n\t\t\t// Add a slight random vertical offset (0-60px) to break the rigid top alignment\n\t\t\tconst verticalOffset = Math.floor(Math.random() * 0);\n\t\t\tfigure.style.transform = `translateY(${verticalOffset}px)`;\n\t\t});\n\n\n\t}\n\n\n\tinitializeNavigation(initialRoute = false) {\n\t\t// console.log('initialize navigation');\n\t\tthis.setNavigationListeners(initialRoute);\n\t}\n\n\tsetNavigationListeners(initialRoute = false) {\n\t\tthis.initializeNavEvents();\n\t\tthis.initializeProjectsEvents();\n\t\tthis.initializeGalleryEvents(initialRoute);\n\t}\n\n\tinitializeNavEvents() {\n\t\tdocument.querySelector('.home-link').addEventListener('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tif (this.isMobile) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.closeMobileMenus();\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t\tthis.navigate('/', { state: 'featured' });\n\t\t});\n\n\t\tdocument.querySelector('.featured-link').addEventListener('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tif (this.isMobile) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.closeMobileMenus();\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t\tthis.navigate('/', { state: 'featured' });\n\t\t});\n\n\t\tdocument.querySelector('.index-link').addEventListener('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tif (this.isMobile) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.closeMobileMenus();\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t\tthis.navigate('/projects', { state: 'index' });\n\t\t});\n\n\t\tdocument.querySelector('.about-link').addEventListener('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tif (this.isMobile) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.closeMobileMenus();\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t\tthis.navigate('/about', { state: 'about' });\n\t\t});\n\n\t\tconst filterLinks = document.querySelectorAll('.filter-button');\n\t\tfilterLinks.forEach(link => {\n\t\t\tlink.addEventListener('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst filter = link.dataset.filter;\n\t\t\t\tif (this.isMobile) {\n\t\t\t\t\tthis.closeMobileMenus();\n\t\t\t\t}\n\t\t\t\tif (link.classList.contains('active-filter') || filter === 'all') {\n\t\t\t\t\tthis.navigate('/projects', { state: 'index' });\n\t\t\t\t} else {\n\t\t\t\t\tthis.navigate(`/filter/${filter}`, { state: 'filter', filter });\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tif (!this.isMobile() && !this.isTouch()) {\n\t\t\tlet navTimeout; // To store the timeout ID\n\t\t\tconst nav = document.querySelector('nav'); // Replace with the actual nav selector\n\t\t\tnav.addEventListener('mouseenter', () => {\n\t\t\t\tclearTimeout(navTimeout);\n\t\t\t\tnavTimeout = setTimeout(() => {\n\t\t\t\t\tdocument.body.classList.add('highlight-nav');\n\t\t\t\t}, 500);\n\t\t\t});\n\n\t\t\tnav.addEventListener('mouseleave', () => {\n\t\t\t\tclearTimeout(navTimeout);\n\t\t\t\tdocument.body.classList.remove('highlight-nav');\n\t\t\t});\n\t\t}\n\t}\n\n\tinitializeProjectsEvents() {\n\t\tconst projectLinks = document.querySelectorAll('.project-link');\n\t\tconst pageTitle = document.querySelector('.page-title'); // Target the page title element\n\t\tlet hoverTimeout = null; // Variable to store the timeout ID\n\n\t\tprojectLinks.forEach(link => {\n\t\t\tconst figure = link.closest('figure'); // Get the figure associated with the link\n\n\n\t\t\tif (!this.isMobile() && !this.isTouch()) {\n\t\t\t\t// Hover event with a 200ms delay\n\t\t\t\tlink.addEventListener('mouseenter', () => {\n\n\t\t\t\t\tif (this.preventInteraction) return;\n\n\t\t\t\t\thoverTimeout = setTimeout(() => {\n\t\t\t\t\t\tconst title = figure.dataset.title; // Get the data-title attribute\n\t\t\t\t\t\tif (title) {\n\t\t\t\t\t\t\tpageTitle.textContent = title; // Set the page title to the figure's title\n\t\t\t\t\t\t\tdocument.body.classList.add('show-title');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Add 'not-selected' to other figures in the parent container\n\t\t\t\t\t\tconst parentContainer = figure.closest('.index, .featured');\n\t\t\t\t\t\tif (parentContainer) {\n\t\t\t\t\t\t\tconst otherFigures = parentContainer.querySelectorAll('figure');\n\t\t\t\t\t\t\totherFigures.forEach(otherFigure => {\n\t\t\t\t\t\t\t\tif (otherFigure !== figure && otherFigure.dataset.projectSlug !== figure.dataset.projectSlug) {\n\t\t\t\t\t\t\t\t\totherFigure.classList.add('not-selected');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 500); // Delay of 200ms\n\t\t\t\t});\n\n\t\t\t\t// Clear the timeout and reset classes on mouseleave\n\t\t\t\tlink.addEventListener('mouseleave', () => {\n\t\t\t\t\tclearTimeout(hoverTimeout);\n\t\t\t\t\thoverTimeout = null;\n\t\t\t\t\tdocument.body.classList.remove('show-title');\n\n\t\t\t\t\t// Remove 'not-selected' from all figures in the parent container\n\t\t\t\t\tconst parentContainer = figure.closest('.index, .featured');\n\t\t\t\t\tif (parentContainer) {\n\t\t\t\t\t\tconst allFigures = parentContainer.querySelectorAll('figure');\n\t\t\t\t\t\tallFigures.forEach(otherFigure => otherFigure.classList.remove('not-selected'));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t\t// Clear the timeout on click\n\t\t\tlink.addEventListener('click', (e) => {\n\t\t\t\tclearTimeout(hoverTimeout);\n\t\t\t\thoverTimeout = null;\n\t\t\t\te.preventDefault(); // Prevent default navigation\n\n\t\t\t\tconst title = figure.dataset.title; // Get the data-title attribute\n\t\t\t\tif (title) {\n\t\t\t\t\tpageTitle.textContent = title; // Set the page title to the figure's title\n\t\t\t\t\t// document.body.classList.add('show-title');\n\t\t\t\t}\n\n\t\t\t\tconst projectSlug = figure.dataset.projectSlug;\n\t\t\t\tlet allFigures = null;\n\n\t\t\t\tif (document.querySelector('.featured').classList.contains('active-section')) {\n\t\t\t\t\tallFigures = document.querySelectorAll('.index figure[data-categories*=\"featured\"]');\n\t\t\t\t} else {\n\t\t\t\t\tallFigures = document.querySelectorAll('.index figure:not(.unfiltered-figure)');\n\t\t\t\t}\n\n\t\t\t\tdocument.body.classList.add('hold-title');\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tdocument.body.classList.remove('hold-title');\n\t\t\t\t}, 1000);\n\n\t\t\t\t// Navigate to the gallery and pass the clicked `figure`\n\t\t\t\tthis.navigate(`/projects/${projectSlug}`, { state: 'project', project: projectSlug });\n\t\t\t\tthis.showProject(projectSlug, figure, allFigures);\n\t\t\t});\n\t\t});\n\t}\n\n\tinitializeGalleryEvents(initialRoute = false) {\n\t\tconst prevButton = document.querySelector('.project-controls .previous');\n\t\tconst nextButton = document.querySelector('.project-controls .next');\n\t\tconst closeButton = document.querySelector('.project-controls .close');\n\t\tconst galleryInner = document.querySelector('.gallery-inner');\n\n\t\tconst updateGallery = (direction) => {\n\t\t\tconst slides = Array.from(galleryInner.querySelectorAll('.gallery-slide'));\n\n\t\t\t// Hide all slides to ensure only one is visible\n\t\t\tslides.forEach(slide => slide.classList.add('hide-slide'));\n\n\t\t\t// Update the current index based on the direction\n\t\t\tif (direction === 'next') {\n\t\t\t\tthis.currentIndex = (this.currentIndex + 1) % slides.length;\n\t\t\t\tthis.loadAdjacentSlides(slides[this.currentIndex]);\n\t\t\t} else if (direction === 'prev') {\n\t\t\t\tthis.currentIndex = (this.currentIndex - 1 + slides.length) % slides.length;\n\t\t\t\tthis.loadAdjacentSlides(slides[this.currentIndex]);\n\t\t\t}\n\n\t\t\t// Show the new current slide\n\t\t\tconst currentSlide = slides[this.currentIndex];\n\t\t\tcurrentSlide.classList.remove('hide-slide');\n\n\t\t\tconst currentFigures = currentSlide.querySelectorAll('figure');\n\t\t\tcurrentFigures.forEach(figure => {\n\n\n\n\t\t\t\tif (this.isSafari) {\n\t\t\t\t\tthis.setGalleryFigureWidthSafari(figure);\n\n\t\t\t\t\tif (figure.querySelector('video')) {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tconst loadedVideo = figure.querySelector('video');\n\t\t\t\t\t\t\tthis.setVideoDimensions(loadedVideo);\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t});\n\n\t\t\t// Update the page title with the title of the current slide\n\t\t\tconst currentSlideFirstFigure = slides[this.currentIndex].querySelector('figure:nth-child(1)');\n\t\t\tconst currentSlideTitle = currentSlideFirstFigure.dataset.title;\n\n\t\t\tif (!this.isMobile() && !document.body.classList.contains('hidden-page')) {\n\t\t\t\tconst pageTitle = document.querySelector('.page-title');\n\t\t\t\tif (currentSlideTitle && pageTitle && pageTitle.textContent !== currentSlideTitle) {\n\t\t\t\t\t// Use GSAP for fade-out and fade-in\n\t\t\t\t\tgsap.timeline()\n\t\t\t\t\t\t.to(pageTitle, {\n\t\t\t\t\t\t\topacity: 0, // Fade out\n\t\t\t\t\t\t\tduration: 0.2, // Quicker animation\n\t\t\t\t\t\t\tease: \"power1.out\",\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.add(() => {\n\t\t\t\t\t\t\tpageTitle.textContent = currentSlideTitle; // Update title text\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.to(pageTitle, {\n\t\t\t\t\t\t\topacity: 1, // Fade in\n\t\t\t\t\t\t\tduration: 0.2, // Quicker animation\n\t\t\t\t\t\t\tease: \"power1.in\",\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst pageTitle = document.querySelector('.page-title');\n\t\t\t\tif (currentSlideTitle && pageTitle) {\n\t\t\t\t\tpageTitle.textContent = currentSlideTitle;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Update the gallery-index for the current project's slide count\n\t\t\tconst currentProjectSlug = currentSlideFirstFigure.dataset.projectSlug;\n\t\t\tconst projectSlides = slides.filter(slide =>\n\t\t\t\tslide.querySelector('figure:nth-child(1)').dataset.projectSlug === currentProjectSlug\n\t\t\t);\n\t\t\tconst projectIndex = (projectSlides.indexOf(currentSlide) + 1).toString().padStart(2, '0'); // Ensures 2 digits\n\t\t\tconst projectTotal = projectSlides.length.toString().padStart(2, '0'); // Ensures 2 digits\n\n\n\t\t\tconst galleryIndexElement = document.querySelector('.project-index');\n\t\t\tif (galleryIndexElement) {\n\t\t\t\tgalleryIndexElement.textContent = `${projectIndex} | ${projectTotal}`;\n\t\t\t}\n\n\t\t\t// Check if the slug of the new slide is different from the current active slide\n\t\t\tconst newSlug = currentSlideFirstFigure.dataset.projectSlug;\n\t\t\tconst currentActiveSlug = slides[this.currentIndex].dataset.projectSlug;\n\n\t\t\tif (newSlug && newSlug !== currentActiveSlug) {\n\t\t\t\tconst newUrl = `${this.basePath}/projects/${newSlug}`;\n\t\t\t\thistory.replaceState({ state: 'project', project: newSlug }, '', newUrl);\n\t\t\t}\n\n\t\t\t// If it's a hidden page, check caption\n\t\t\tif (document.body.classList.contains('hidden-page')) {\n\t\t\t\tthis.checkForCaption();\n\t\t\t}\n\t\t};\n\n\t\tlet clearInitialRoute = false;\n\n\t\tif (!this.isMobile()) {\n\t\t\tdocument.querySelector('.gallery').addEventListener('click', (e) => {\n\t\t\t\t// Check if the target is a video or inside a video element\n\t\t\t\tif (e.target.tagName.toLowerCase() === 'video' || e.target.closest('video')) {\n\t\t\t\t\treturn; // Do nothing if it's a video\n\t\t\t\t}\n\n\t\t\t\t// Find the closest slide\n\t\t\t\tconst slide = e.target.closest('.gallery-slide');\n\t\t\t\tif (slide) {\n\t\t\t\t\tconst clickX = e.clientX; // Get the horizontal click position\n\t\t\t\t\tconst screenWidth = window.innerWidth; // Get the viewport width\n\n\t\t\t\t\tif (clickX < screenWidth / 2) {\n\t\t\t\t\t\tupdateGallery('prev'); // Clicked on the left side\n\t\t\t\t\t} else {\n\t\t\t\t\t\tupdateGallery('next'); // Clicked on the right side\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst hammer = new Hammer(document.querySelector('.gallery'));\n\t\thammer.on('swiperight', () => {\n\t\t\tupdateGallery('prev');\n\t\t});\n\t\thammer.on('swipeleft', () => {\n\t\t\tupdateGallery('next');\n\t\t});\n\n\t\tprevButton.addEventListener('click', () => updateGallery('prev'));\n\t\tnextButton.addEventListener('click', () => updateGallery('next'));\n\t\tcloseButton.addEventListener('click', () => {\n\t\t\tif ((initialRoute && !clearInitialRoute) || document.body.classList.contains('hidden-page')) {\n\t\t\t\t// this.navigate('/', { state: 'featured' });\n\t\t\t\t// clearInitialRoute = true;\n\t\t\t\twindow.location.href = document.body.getAttribute('data-basepath');\n\t\t\t} else {\n\t\t\t\thistory.back();\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener('keydown', (event) => {\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'ArrowLeft': // Navigate to the previous slide\n\t\t\t\t\tupdateGallery('prev');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowRight': // Navigate to the next slide\n\t\t\t\t\tupdateGallery('next');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Escape': // Close the gallery\n\t\t\t\t\thistory.back();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak; // Ignore other keys\n\t\t\t}\n\t\t});\n\t}\n\n\tcheckForCaption() {\n\t\tconst activeSlide = document.querySelector('.gallery-slide:not(.hide-slide)');\n\t\tif (!activeSlide) return;\n\t\tconst figures = activeSlide.querySelectorAll('figure');\n\t\tconst hiddenCaption = document.querySelector('.hidden-caption');\n\n\t\t// Initialize caption as empty\n\t\tlet caption = '';\n\n\t\t// Loop through the figures to find the first data-caption\n\t\tfigures.forEach(figure => {\n\t\t\tif (figure.dataset.caption) {\n\t\t\t\tcaption = figure.dataset.caption;\n\t\t\t}\n\t\t});\n\n\t\t// Set the content and display of .hidden-caption\n\t\tif (caption) {\n\t\t\thiddenCaption.textContent = caption;\n\t\t\thiddenCaption.style.display = 'block';\n\t\t} else {\n\t\t\thiddenCaption.textContent = '';\n\t\t\thiddenCaption.style.display = 'none';\n\t\t}\n\n\t}\n\n\tinitializeGallery(projectSlug, clickedFigure = null, allFigures, initialRoute = false) {\n\n\t\t// console.log(initialRoute);\n\n\t\tconst galleryInner = document.querySelector('.gallery-inner');\n\t\tconst figures = Array.from(document.querySelectorAll('.index figure'));\n\n\n\t\tconst activeFigures = allFigures ? allFigures : document.querySelectorAll('.index figure');\n\t\tgalleryInner.innerHTML = ''; // Clear existing gallery content\n\t\tconst slides = [];\n\t\tlet currentSlide = [];\n\n\t\tconst activeFiguresArray = Array.from(activeFigures); // Convert NodeList to an array for mutability\n\t\tconst processedIndices = new Set(); // Keep track of indices that have been added to slides\n\n\t\tactiveFiguresArray.forEach((figure, index) => {\n\t\t\tif (processedIndices.has(index)) return; // Skip figures that have already been added to a slide\n\n\t\t\tconst isDiptych = figure.dataset.isDiptych === 'true';\n\t\t\tconst nextFigure = activeFiguresArray[index + 1];\n\t\t\tconst sameProject = nextFigure?.dataset.projectSlug === figure.dataset.projectSlug;\n\n\t\t\tif (isDiptych && sameProject) {\n\t\t\t\t// Add the current figure and the next figure as a diptych\n\t\t\t\tslides.push([figure, nextFigure]);\n\t\t\t\tprocessedIndices.add(index); // Mark the current figure as processed\n\t\t\t\tprocessedIndices.add(index + 1); // Mark the next figure as processed\n\t\t\t} else {\n\t\t\t\t// Add the current figure as a single slide\n\t\t\t\tslides.push([figure]);\n\t\t\t\tprocessedIndices.add(index); // Mark the current figure as processed\n\t\t\t}\n\t\t});\n\n\t\t// Generate slides dynamically\n\t\tslides.forEach(slideFigures => {\n\t\t\tconst slide = document.createElement('div');\n\t\t\tslide.classList.add('gallery-slide');\n\n\t\t\tslideFigures.forEach(figure => {\n\t\t\t\tconst figureElement = document.createElement('figure');\n\n\t\t\t\t// Map camelCase attributes back to kebab-case\n\t\t\t\tconst attributeMap = {\n\t\t\t\t\ttitle: 'data-title',\n\t\t\t\t\tclient: 'data-client',\n\t\t\t\t\tprojectUrl: 'data-project-url',\n\t\t\t\t\tprojectSlug: 'data-project-slug',\n\t\t\t\t\tgallery: 'data-gallery',\n\t\t\t\t\tgalleryjpeg: 'data-galleryjpeg',\n\t\t\t\t\tgalleryWidth: 'data-gallery-width',\n\t\t\t\t\tgalleryHeight: 'data-gallery-height',\n\t\t\t\t\tisDiptych: 'data-is-diptych',\n\t\t\t\t\tvideoUrl: 'data-video-url',\n\t\t\t\t\tisPortrait: 'data-is-portrait',\n\t\t\t\t\tautoplay: 'data-autoplay',\n\t\t\t\t\tcaption: 'data-caption',\n\t\t\t\t};\n\n\t\t\t\t// Copy relevant data attributes from the index figure to the gallery figure\n\t\t\t\tObject.entries(attributeMap).forEach(([camelCase, kebabCase]) => {\n\t\t\t\t\tif (figure.dataset[camelCase]) {\n\t\t\t\t\t\tfigureElement.setAttribute(kebabCase, figure.dataset[camelCase]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tconst isVideo = figure.dataset.videoUrl !== undefined;\n\t\t\t\tconst mediaUrl = figure.dataset.gallery;\n\t\t\t\tconst mediaWidth = figure.dataset.galleryWidth;\n\t\t\t\tconst mediaHeight = figure.dataset.galleryHeight;\n\n\t\t\t\tif (isVideo) {\n\t\t\t\t\tconst videoElement = document.createElement('video');\n\t\t\t\t\tvideoElement.src = figure.dataset.videoUrl;\n\t\t\t\t\tvideoElement.poster = figure.dataset.galleryjpeg || '';\n\t\t\t\t\tvideoElement.width = mediaWidth ? parseInt(mediaWidth, 10) : undefined;\n\t\t\t\t\tvideoElement.height = mediaHeight ? parseInt(mediaHeight, 10) : undefined;\n\t\t\t\t\tvideoElement.loop = true;\n\t\t\t\t\tvideoElement.playsInline = true;\n\t\t\t\t\tvideoElement.preload = 'metadata';\n\t\t\t\t\tif (figure.dataset.autoplay) {\n\t\t\t\t\t\tvideoElement.autoplay = true;\n\t\t\t\t\t\tvideoElement.muted = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvideoElement.controls = true;\n\t\t\t\t\t\tvideoElement.controlsList = 'nodownload';\n\t\t\t\t\t}\n\t\t\t\t\tvideoElement.style.aspectRatio = `${mediaWidth}/${mediaHeight}`;\n\t\t\t\t\tfigureElement.appendChild(videoElement);\n\t\t\t\t} else if (mediaUrl) {\n\t\t\t\t\tconst imgElement = document.createElement('img');\n\t\t\t\t\timgElement.src = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\t\t\t\t\timgElement.dataset.src = mediaUrl;\n\t\t\t\t\timgElement.dataset.srcjpeg = figure.dataset.galleryjpeg;\n\t\t\t\t\timgElement.width = mediaWidth ? parseInt(mediaWidth, 10) : undefined;\n\t\t\t\t\timgElement.height = mediaHeight ? parseInt(mediaHeight, 10) : undefined;\n\t\t\t\t\tfigureElement.appendChild(imgElement);\n\t\t\t\t}\n\n\t\t\t\tslide.appendChild(figureElement);\n\t\t\t});\n\n\t\t\tgalleryInner.appendChild(slide);\n\t\t});\n\n\t\t// Ensure all slides are hidden initially\n\t\tconst slidesInGallery = galleryInner.querySelectorAll('.gallery-slide');\n\t\tslidesInGallery.forEach(slide => (slide.classList.add('hide-slide')));\n\n\t\t// Determine the starting slide index\n\t\tlet startIndex = 0;\n\t\t// if (clickedFigure && clickedFigure.closest('.index')) {\n\t\tif (clickedFigure) {\n\t\t\tconst clickedGallery = clickedFigure.dataset.gallery;\n\t\t\tstartIndex = slides.findIndex(slide =>\n\t\t\t\tArray.from(slide).some(figure => figure.dataset.gallery === clickedGallery)\n\t\t\t);\n\t\t\tif (startIndex === -1) startIndex = 0;\n\t\t} else {\n\t\t\tstartIndex = slides.findIndex(slide =>\n\t\t\t\tslide.some(figure => figure.dataset.projectSlug === projectSlug)\n\t\t\t);\n\t\t\tif (startIndex === -1) startIndex = 0;\n\t\t}\n\n\t\t// Show the starting slide\n\t\tif (slidesInGallery[startIndex]) {\n\t\t\tconst startingSlideTitle = slidesInGallery[startIndex].querySelector('figure').dataset.title;\n\t\t\tconst pageTitle = document.querySelector('.page-title');\n\t\t\tif (startingSlideTitle && pageTitle) {\n\t\t\t\tpageTitle.textContent = startingSlideTitle;\n\t\t\t}\n\n\t\t\tslidesInGallery[startIndex].classList.remove('hide-slide');\n\n\t\t\tthis.loadMedia(slidesInGallery[startIndex]);\n\t\t\tthis.loadAdjacentSlides(slidesInGallery[startIndex]);\n\n\t\t\t// Synchronize currentIndex with the starting slide\n\t\t\tthis.currentIndex = startIndex;\n\n\t\t\tconst currentFigures = slidesInGallery[startIndex].querySelectorAll('figure');\n\t\t\tcurrentFigures.forEach(figure => {\n\n\n\t\t\t\tif (this.isSafari) {\n\t\t\t\t\tthis.setGalleryFigureWidthSafari(figure);\n\n\t\t\t\t\tif (figure.querySelector('video')) {\n\t\t\t\t\t\tconst loadedVideo = figure.querySelector('video');\n\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.setVideoDimensions(loadedVideo);\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\n\t\t\t\t// if (this.isSafari) {\n\t\t\t\t// \tthis.setGalleryFigureWidthSafari(figure);\n\t\t\t\t// }\n\t\t\t});\n\t\t}\n\n\t\t// Show the total number of slides\n\t\tif (slidesInGallery[startIndex]) {\n\t\t\tconst startingSlideTitle = slidesInGallery[startIndex].querySelector('figure').dataset.title;\n\t\t\tconst pageTitle = document.querySelector('.page-title');\n\t\t\tif (startingSlideTitle && pageTitle) {\n\t\t\t\tpageTitle.textContent = startingSlideTitle;\n\t\t\t}\n\n\t\t\tslidesInGallery[startIndex].classList.remove('hide-slide');\n\n\t\t\tthis.loadMedia(slidesInGallery[startIndex]);\n\t\t\tthis.loadAdjacentSlides(slidesInGallery[startIndex]);\n\n\t\t\t// Synchronize currentIndex with the starting slide\n\t\t\tthis.currentIndex = startIndex;\n\n\t\t\t// Update the gallery-index\n\t\t\tconst currentSlide = slides[startIndex];\n\t\t\tconst currentProjectSlug = currentSlide[0].dataset.projectSlug;\n\t\t\tconst projectSlides = slides.filter(slide =>\n\t\t\t\tslide.some(figure => figure.dataset.projectSlug === currentProjectSlug)\n\t\t\t);\n\t\t\tconst projectIndex = String(projectSlides.indexOf(currentSlide) + 1).padStart(2, '0'); // Ensures 2 digits\n\t\t\tconst projectTotal = String(projectSlides.length).padStart(2, '0'); // Ensures 2 digits\n\n\t\t\tconst galleryIndexElement = document.querySelector('.project-index');\n\t\t\tif (galleryIndexElement) {\n\t\t\t\tgalleryIndexElement.textContent = `${projectIndex} | ${projectTotal}`;\n\t\t\t}\n\t\t}\n\t}\n\n\tinitializeHiddenGallery() {\n\n\t\tconst firstSlide = document.querySelector('.gallery .gallery-slide:first-child');\n\n\t\tthis.loadAdjacentSlides(document.querySelector('.gallery .gallery-slide:first-child'));\n\n\t\tconst currentFigures = firstSlide.querySelectorAll('figure');\n\t\tcurrentFigures.forEach(figure => {\n\n\t\t\tif (this.isSafari) {\n\t\t\t\tthis.setGalleryFigureWidthSafari(figure);\n\n\t\t\t\tif (figure.querySelector('video')) {\n\t\t\t\t\tconst loadedVideo = figure.querySelector('video');\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.setVideoDimensions(loadedVideo);\n\t\t\t\t\t}, 100);\n\t\t\t\t}\n\t\t\t}\n\n\n\n\n\t\t});\n\t}\n\n\tstartVideos(videos) {\n\n\t\tvideos.forEach(video => {\n\t\t\tvideo.play();\n\t\t});\n\n\t}\n\n\tstopVideos(videos) {\n\n\t\tvideos.forEach(video => {\n\t\t\tvideo.pause();\n\t\t});\n\n\t}\n\n\tloadAdjacentSlides(currentSlide) {\n\t\tconst slides = Array.from(document.querySelectorAll('.gallery-slide'));\n\t\tconst currentIndex = slides.findIndex(slide => slide === currentSlide);\n\t\tconst totalSlides = slides.length;\n\n\t\t// Calculate indices for two before and two after with looping\n\t\tconst indicesToLoad = [\n\t\t\t(currentIndex - 2 + totalSlides) % totalSlides,\n\t\t\t(currentIndex - 1 + totalSlides) % totalSlides,\n\t\t\tcurrentIndex,\n\t\t\t(currentIndex + 1) % totalSlides,\n\t\t\t(currentIndex + 2) % totalSlides,\n\t\t];\n\n\t\t// Load media for the required slides\n\t\tindicesToLoad.forEach(index => {\n\t\t\tthis.loadMedia(slides[index]);\n\t\t});\n\n\t\t// Stop all videos except for those on the current slide\n\t\tslides.forEach((slide, index) => {\n\t\t\tconst videos = slide.querySelectorAll('video');\n\t\t\tif (index === currentIndex) {\n\t\t\t\t// Start videos for the current slide\n\t\t\t\t// if the video has attr autoplay\n\t\t\t\tvideos.forEach(video => {\n\t\t\t\t\tif (video.hasAttribute('autoplay')) {\n\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// this.startVideos(videos);\n\t\t\t} else {\n\t\t\t\t// Stop videos for other slides\n\t\t\t\tthis.stopVideos(videos);\n\t\t\t}\n\t\t});\n\t}\n\n\tcheckWebPSupport() {\n\t\tconst canvas = document.createElement('canvas');\n\t\treturn canvas.getContext && canvas.getContext('2d')\n\t\t\t? canvas.toDataURL('image/webp').indexOf('data:image/webp') === 0\n\t\t\t: false;\n\t}\n\n\tloadMedia(container) {\n\n\t\tif (!container) {\n\t\t\tconsole.error('Container element not found');\n\t\t\treturn;\n\t\t}\n\n\n\t\tconst figures = container.querySelectorAll('figure:not(.loaded):not(.loading)');\n\t\tif (!figures.length) return;\n\n\n\t\tfigures.forEach(figure => {\n\t\t\tfigure.classList.add('loading'); // Add loading class\n\n\t\t\tconst video = figure.querySelector('video[data-src]');\n\t\t\tconst img = figure.querySelector('img[data-src]');\n\n\t\t\tconst mediaElements = [];\n\t\t\tif (video) {\n\t\t\t\tvideo.src = video.dataset.src;\n\n\t\t\t\t// if (isSafari) {\n\t\t\t\t// \tvideo.addEventListener('loadeddata', () => {\n\t\t\t\t// \t\tvideo.currentTime = 1; // Set to first frame in Safari\n\t\t\t\t// \t}, { once: true });\n\t\t\t\t// }\n\t\t\t\tmediaElements.push(video);\n\t\t\t}\n\t\t\tif (img) {\n\t\t\t\t// Use data-src for WebP if supported, otherwise data-srcjpeg\n\t\t\t\timg.src = this.checkWebPSupport ? img.dataset.src : img.dataset.srcjpeg;\n\t\t\t\tmediaElements.push(img);\n\t\t\t}\n\n\t\t\t// Wait for all media to load\n\t\t\tPromise.all(mediaElements.map(media => new Promise(resolve => {\n\t\t\t\tif (media.tagName === 'VIDEO') {\n\t\t\t\t\tmedia.onloadeddata = resolve;\n\t\t\t\t} else {\n\t\t\t\t\tmedia.onload = resolve;\n\t\t\t\t}\n\t\t\t\tmedia.onerror = resolve; // Handle errors gracefully\n\t\t\t}))).then(() => {\n\t\t\t\tfigure.classList.remove('loading');\n\t\t\t\tfigure.classList.add('previously-loaded');\n\t\t\t\tfigure.classList.add('loaded');\n\n\t\t\t});\n\t\t});\n\t}\n\n\tsetVideoDimensions(video) {\n\t\trequestAnimationFrame(() => {\n\t\t\tconst containerWidth = video.parentElement.clientWidth; // Width of the parent container\n\t\t\tconst containerHeight = video.parentElement.clientHeight; // Height of the parent container\n\t\t\tconst intrinsicWidth = parseInt(video.getAttribute('width')); // Intrinsic width of the video\n\t\t\tconst intrinsicHeight = parseInt(video.getAttribute('height')); // Intrinsic height of the video\n\n\t\t\tif (!intrinsicWidth || !intrinsicHeight) return; // Fail-safe if intrinsic dimensions are unavailable\n\n\t\t\t// Calculate effective dimensions based on object-fit: contain\n\t\t\tconst widthRatio = containerWidth / intrinsicWidth;\n\t\t\tconst heightRatio = containerHeight / intrinsicHeight;\n\t\t\tconst scale = Math.min(widthRatio, heightRatio); // Scale to fit within container\n\n\t\t\tconst finalWidth = Math.round(intrinsicWidth * scale); // Final rendered width\n\t\t\tconst finalHeight = Math.round(intrinsicHeight * scale); // Final rendered height\n\n\t\t\t// Set the video element's width and height attributes to match its rendered size\n\t\t\tvideo.style.width = `${finalWidth}px`;\n\t\t\tvideo.style.height = `${finalHeight}px`;\n\n\t\t});\n\t}\n\n\tsetGalleryFigureWidthSafari(figure) {\n\t\t// if (!figure.dataset.isDiptych) return;\n\t\tif (figure.dataset.isDiptych !== \"true\") return;\n\n\t\tconst media = figure.querySelector('img, video');\n\t\tif (!media) return;\n\n\t\t// const containerWidth = figure.clientWidth;\n\t\tconst containerWidth = this.isMobile ? (window.innerWidth - 40) / 2 : (window.innerWidth - 180) / 2;\n\t\t// const containerHeight = figure.clientHeight;\n\t\tconst containerHeight = this.isMobile ? (window.innerHeight - 100) : (window.innerHeight - 190);\n\n\t\tconst intrinsicWidth = parseInt(media.getAttribute('width')); // Intrinsic width\n\t\tconst intrinsicHeight = parseInt(media.getAttribute('height')); // Intrinsic height\n\n\t\t// console.log(containerWidth, containerHeight, intrinsicWidth, intrinsicHeight);\n\n\n\t\tif (!intrinsicWidth || !intrinsicHeight) return; // Fail-safe if intrinsic dimensions are unavailable\n\n\t\t// Calculate effective dimensions based on object-fit: contain\n\t\tconst widthRatio = containerWidth / intrinsicWidth;\n\t\tconst heightRatio = containerHeight / intrinsicHeight;\n\t\tconst scale = Math.min(widthRatio, heightRatio); // Scale to fit within container\n\n\t\tconst finalWidth = intrinsicWidth * scale; // Final rendered width\n\t\tfigure.style.width = `${finalWidth}px`;\n\n\t\t// Check and adjust the next sibling figure if it also has data-is-diptych\n\t\tconst nextFigure = figure.nextElementSibling;\n\t\tif (nextFigure) {\n\t\t\tconst nextMedia = nextFigure.querySelector('img, video');\n\t\t\tif (nextMedia) {\n\t\t\t\tconst nextIntrinsicWidth = parseInt(nextMedia.getAttribute('width'));\n\t\t\t\tconst nextIntrinsicHeight = parseInt(nextMedia.getAttribute('height'));\n\n\t\t\t\tconst nextWidthRatio = containerWidth / nextIntrinsicWidth;\n\t\t\t\tconst nextHeightRatio = containerHeight / nextIntrinsicHeight;\n\t\t\t\tconst nextScale = Math.min(nextWidthRatio, nextHeightRatio);\n\n\t\t\t\tconst nextFinalWidth = nextIntrinsicWidth * nextScale;\n\t\t\t\tnextFigure.style.width = `${nextFinalWidth}px`;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nif (document.readyState === 'loading') {\n\tdocument.addEventListener('DOMContentLoaded', () => Landing.init());\n} else {\n\tLanding.init();\n}","import home from 'modules/home';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    new home();\n});\n"],"mappings":"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","ignoreList":[]}